<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">

        <title>Geolocation</title>
    </head>
    <body>
        <script type="text/javascript">
            if (navigator.geolocation) {

                function handleSuccess(position) {
                    var message = {
                        type: 'locateSuccess',
                        accuracy: position.coords.accuracy,
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude
                    };

                    parent.postMessage(message, parent.location.origin);
                };

                function handleError(error) {
                    var message = {
                        type: 'locateError',
                        error: error.message
                    };

                    parent.postMessage(message, parent.location.origin);
                }

                var options = {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                };

                navigator.geolocation.watchPosition(handleSuccess, handleError, options);
            }
        </script>
    </body>
</html>
